syntax = "proto3";

package proto;

// chat service definition
service ChatService {
	rpc Packet(stream Chat.Packet) returns (stream Chat.Packet);  // 透传消息, 双向流
	// Control API
	rpc Reg(Chat.Id) returns (Chat.Nil);	// 注册一个聊天用户
	rpc UpdateInfo(Chat.Id) returns (Chat.Nil);	// 更新用户信息
	rpc RegMuc(Chat.MucReq) returns (Chat.Nil); // 注册一个MUC
	rpc JoinMuc(Chat.MucReq) returns (Chat.Nil); // 加入一个MUC
	rpc LeaveMuc(Chat.MucReq) returns (Chat.Nil); // 离开一个MUC
}

message Chat {
	message Nil { }
	message Packet {
		int32 Uid=1;	// user id
		bytes Content=2;
	}
	message Id {
		int32 Id=1;
		string Name=2;	// 用户名
	}
	message MucReq{
		int32 MucId=1;		// multi user chat id
		int32 UserId=2;		// user id
	}
}
